# SWAP settings
vm.swappiness=0
vm.panic_on_oom=0
vm.overcommit_memory=1
vm.max_map_count=262144

# Kernel panic settings
kernel.panic=10
kernel.panic_on_oops=1

# Network settings
net.ipv4.ip_local_port_range=1024 65000
net.core.somaxconn=10000
net.ipv4.tcp_tw_reuse=1
net.ipv4.tcp_fin_timeout=15
net.core.netdev_max_backlog=4096
net.core.rmem_max=16777216
net.core.wmem_max=16777216
net.core.rmem_default=7340032

# TCP settings
net.ipv4.tcp_max_syn_backlog=20480
net.ipv4.tcp_max_tw_buckets=400000
net.ipv4.tcp_no_metrics_save=1
net.ipv4.tcp_rmem=4096 87380 16777216
net.ipv4.tcp_syn_retries=2
net.ipv4.tcp_synack_retries=2
net.ipv4.tcp_wmem=4096 65536 16777216

# ARP cache settings
net.ipv4.neigh.default.gc_thresh1=8096
net.ipv4.neigh.default.gc_thresh2=12288
net.ipv4.neigh.default.gc_thresh3=16384

# IP forwarding and TCP keepalive
net.ipv4.tcp_keepalive_time=600
net.ipv4.ip_forward=1

# File system monitoring
fs.inotify.max_user_instances=8192
fs.inotify.max_user_watches=524288
fs.inotify.max_queued_events=16384
fs.file-max=131072

# User limits
user.max_inotify_instances=8192
user.max_inotify_watches=524288

# IPv6 settings for Canal CNI
net.ipv6.conf.all.disable_ipv6=0
net.ipv6.conf.default.disable_ipv6=0
net.ipv6.conf.all.forwarding=1
net.ipv6.conf.default.forwarding=1
net.ipv6.conf.all.accept_ra=2
net.ipv6.conf.default.accept_ra=2
net.bridge.bridge-nf-call-ip6tables=1
net.bridge.bridge-nf-call-iptables=1

# Bridge settings for Canal CNI
net.bridge.bridge-nf-call-arptables=1
net.ipv6.conf.all.autoconf=1
net.ipv6.conf.default.autoconf=1

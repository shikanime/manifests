apiVersion: controlplane.cluster.x-k8s.io/v1beta1
kind: K0sControlPlaneTemplate
metadata:
  name: hetzner-fsn1
  namespace: nishir
spec:
  template:
    spec:
      k0sConfigSpec:
        k0s:
          apiVersion: k0s.k0sproject.io/v1beta1
          kind: ClusterConfig
          metadata:
            name: k0s
          spec:
            api:
              port: 6443
              extraArgs:
                anonymous-auth: "true"
            extensions:
              helm:
                repositories:
                  - name: fairwinds-stable
                    url: https://charts.fairwinds.com/stable
                  - name: jetstack
                    url: https://charts.jetstack.io
                  - name: kubernetes-sigs-cluster-api-operator
                    url: https://kubernetes-sigs.github.io/cluster-api-operator
                  - name: kubernetes-sigs-descheduler
                    url: https://kubernetes-sigs.github.io/descheduler
                  - name: kubernetes-sigs-nfd
                    url: https://kubernetes-sigs.github.io/node-feature-discovery/charts
                  - name: longhorn
                    url: https://charts.longhorn.io
                  - name: tailscale
                    url: https://pkgs.tailscale.com/helmcharts
                charts:
                  - name: cert-manager
                    chartname: jetstack/cert-manager
                    version: "v1.18.2"
                    namespace: cert-manager-system
                    values: |
                      clusterResourceNamespace: cert-manager-trust
                      crds:
                        enabled: true
                  - name: cluster-api-operator
                    chartname: kubernetes-sigs-cluster-api-operator/cluster-api-operator
                    version: "v0.15.0"
                    namespace: capi-operator-system
                    values: |
                      crds:
                        enabled: true